<div class="profile-container">
  <!-- En-tête de la page -->
  <div class="profile-header">
    <h1>Mon Profil</h1>
    <p>Gérez vos informations personnelles et votre mot de passe</p>
  </div>

  <!-- Messages de succès/erreur -->
  <div class="messages-container" *ngIf="successMessage || errorMessage">
    <div class="alert alert-success" *ngIf="successMessage">
      <svg class="alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
      {{ successMessage }}
    </div>
    <div class="alert alert-error" *ngIf="errorMessage">
      <svg class="alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
      {{ errorMessage }}
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Chargement de votre profil...</p>
  </div>

  <!-- Contenu principal -->
  <div class="profile-content" *ngIf="!isLoading">
    <!-- Onglets -->
    <div class="tabs-container">
      <button 
        class="tab-button" 
        [class.active]="activeTab === 'profile'"
        (click)="setActiveTab('profile')">
        <svg class="tab-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        Informations personnelles
      </button>
      <button 
        class="tab-button" 
        [class.active]="activeTab === 'password'"
        (click)="setActiveTab('password')">
        <svg class="tab-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
        </svg>
        Changer le mot de passe
      </button>
    </div>

    <!-- Onglet Informations personnelles -->
    <div class="tab-content" *ngIf="activeTab === 'profile'">
      <div class="profile-info">
        <div class="info-card">
          <h3>Informations actuelles</h3>
          <div class="info-grid" *ngIf="userProfile">
            <div class="info-item">
              <span class="info-label">Nom :</span>
              <span class="info-value">{{ userProfile.nom }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Email :</span>
              <span class="info-value">{{ userProfile.email }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Sexe :</span>
              <span class="info-value">{{ userProfile.sexe === 'HOMME' ? 'Homme' : 'Femme' }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Membre depuis :</span>
              <span class="info-value">{{ formatDate(userProfile.dateCreation) }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Dernière connexion :</span>
              <span class="info-value">{{ formatDate(userProfile.derniereConnexion) }}</span>
            </div>
          </div>
        </div>

        <div class="form-card">
          <h3>Modifier mes informations</h3>
          <form [formGroup]="profileForm" (ngSubmit)="updateProfile()" class="profile-form">
            <div class="form-group">
              <label for="nom">Nom complet *</label>
              <input 
                type="text" 
                id="nom" 
                formControlName="nom" 
                class="form-input"
                [class.error]="getProfileFormErrors('nom')"
                placeholder="Votre nom complet">
              <div class="error-message" *ngIf="getProfileFormErrors('nom')">
                {{ getProfileFormErrors('nom') }}
              </div>
            </div>

            <div class="form-group">
              <label for="email">Email *</label>
              <input 
                type="email" 
                id="email" 
                formControlName="email" 
                class="form-input"
                [class.error]="getProfileFormErrors('email')"
                placeholder="votre.email@exemple.com">
              <div class="error-message" *ngIf="getProfileFormErrors('email')">
                {{ getProfileFormErrors('email') }}
              </div>
            </div>

            <div class="form-group">
              <label for="sexe">Sexe *</label>
              <select 
                id="sexe" 
                formControlName="sexe" 
                class="form-input"
                [class.error]="getProfileFormErrors('sexe')">
                <option value="">Sélectionnez votre sexe</option>
                <option value="HOMME">Homme</option>
                <option value="FEMME">Femme</option>
              </select>
              <div class="error-message" *ngIf="getProfileFormErrors('sexe')">
                {{ getProfileFormErrors('sexe') }}
              </div>
            </div>

            <div class="form-actions">
              <button 
                type="submit" 
                class="btn btn-primary"
                [disabled]="!profileForm.valid || isUpdatingProfile">
                <svg class="btn-icon" *ngIf="isUpdatingProfile" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                {{ isUpdatingProfile ? 'Mise à jour...' : 'Mettre à jour le profil' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Onglet Changer le mot de passe -->
    <div class="tab-content" *ngIf="activeTab === 'password'">
      <div class="password-card">
        <h3>Changer mon mot de passe</h3>
        <p class="password-info">
          Pour changer votre mot de passe, veuillez saisir votre mot de passe actuel et le nouveau mot de passe souhaité.
        </p>
        
        <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="password-form">
          <div class="form-group">
            <label for="ancienMotDePasse">Mot de passe actuel *</label>
            <input 
              type="password" 
              id="ancienMotDePasse" 
              formControlName="ancienMotDePasse" 
              class="form-input"
              [class.error]="getPasswordFormErrors('ancienMotDePasse')"
              placeholder="Votre mot de passe actuel">
            <div class="error-message" *ngIf="getPasswordFormErrors('ancienMotDePasse')">
              {{ getPasswordFormErrors('ancienMotDePasse') }}
            </div>
          </div>

          <div class="form-group">
            <label for="nouveauMotDePasse">Nouveau mot de passe *</label>
            <input 
              type="password" 
              id="nouveauMotDePasse" 
              formControlName="nouveauMotDePasse" 
              class="form-input"
              [class.error]="getPasswordFormErrors('nouveauMotDePasse')"
              placeholder="Votre nouveau mot de passe">
            <div class="error-message" *ngIf="getPasswordFormErrors('nouveauMotDePasse')">
              {{ getPasswordFormErrors('nouveauMotDePasse') }}
            </div>
          </div>

          <div class="form-group">
            <label for="confirmerMotDePasse">Confirmer le nouveau mot de passe *</label>
            <input 
              type="password" 
              id="confirmerMotDePasse" 
              formControlName="confirmerMotDePasse" 
              class="form-input"
              [class.error]="getPasswordMismatchError()"
              placeholder="Confirmez votre nouveau mot de passe">
            <div class="error-message" *ngIf="getPasswordMismatchError()">
              {{ getPasswordMismatchError() }}
            </div>
          </div>

          <div class="form-actions">
            <button 
              type="submit" 
              class="btn btn-primary"
              [disabled]="!passwordForm.valid || isChangingPassword">
              <svg class="btn-icon" *ngIf="isChangingPassword" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
              </svg>
              {{ isChangingPassword ? 'Changement...' : 'Changer le mot de passe' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
